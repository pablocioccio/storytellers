<form [formGroup]="gameForm" (ngSubmit)="onSubmit()" *ngIf="game">

  <blockquote class="blockquote text-center mb-3">
    <p class="mb-0">{{game.title}}</p>
    <footer class="blockquote-footer font-italic" *ngIf="game.description">{{game.description}}</footer>
  </blockquote>

  <div class="input-group mb-3">
    <div class="input-group-prepend" *ngIf="game.currentPhraseNumber > 0">
      <span class="input-group-text text-wrap">... {{game.firstWords}}</span>
    </div>
    <textarea id="text" class="form-control"
      [class.is-invalid]="gameForm.controls['text'].errors && (gameForm.controls['text'].dirty || gameForm.controls['text'].touched)"
      [class.is-valid]="gameForm.controls['text'].valid && (gameForm.controls['text'].dirty || gameForm.controls['text'].touched)"
      formControlName="text" aria-label="Text area" [placeholder]="calculatePlaceholderText()"></textarea>
    <div class="invalid-feedback">
      <ng-container *ngIf="gameForm.controls['text'].errors?.minWords">
        You need at least
        {{gameForm.controls['text'].errors.minWords.required - gameForm.controls['text'].errors.minWords.current}}
        more word(s).
      </ng-container>
    </div>
  </div>

  <div class="d-flex mb-3" *ngIf="!isLastPlayer">
    <div class="p-2">
      <b ngbTooltip="Up to a third of the whole content">Slide to reveal more</b>
    </div>
    <div class="p-2 flex-grow-1">
      <input type="range" class="custom-range" id="lastWordsRange" formControlName="lastWordsRange"
        [attr.min]="minLastWords" [attr.max]="maxLastWords">
    </div>
  </div>

  <div #lastWordsContainerTooltip="ngbTooltip" *ngIf="!isLastPlayer"
    class="shadow text-right text-break p-3 mb-5 bg-white rounded border border-info"
    ngbTooltip="This is what the next player will see" triggers="manual">
    ... {{gameForm.value.lastWords}}
  </div>

  <div class="text-center">
    <button type="submit" class="btn btn-primary" [disabled]="!gameForm.valid">
      <span *ngIf="postSubmitted" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      Send
    </button>
  </div>

</form>
